(()=>{"use strict";(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})({});const e=["\\","?","[","]","{","}","(",")",".","^","$"].map((e=>({f:new RegExp("\\"+e,"g"),v:"\\"+e}))),t=(e,t)=>{let r=e;return t.forEach((e=>{r=r.replace(e.f,e.v)})),r};class r{constructor(r,n){this.escapeMap=((r,n)=>{const s=n?"mg":"mgi";return r.map((r=>{if(!r.at||"escape"==r.at)return{f:new RegExp(t(r.char,e),s),v:r.escaped}})).filter((e=>!!e))})(r,n),this.unescapeMap=((r,n)=>{const s=n?"mg":"mgi";return r.map((r=>{if(!r.at||"unescape"==r.at)return{f:new RegExp(t(r.escaped,e),s),v:r.char}})).filter((e=>!!e))})(r,n)}escape(e){return t(e,this.escapeMap)}unescape(e){return t(e,this.unescapeMap)}static REGEXP_ESCAPER(){return new r([{char:"\\",escaped:"\\\\"},{char:"?",escaped:"\\?"},{char:"[",escaped:"\\["},{char:"]",escaped:"\\]"},{char:"{",escaped:"\\{"},{char:"}",escaped:"\\}"},{char:"(",escaped:"\\("},{char:")",escaped:"\\)"},{char:".",escaped:"\\."},{char:"^",escaped:"\\^"},{char:"$",escaped:"\\$"}])}}const n=/^\s(.+)$/,s=/:/,a=/;/,o=/=/,i=new r([{char:",",escaped:"\\,"},{char:";",escaped:"\\;"},{char:":",escaped:"\\:"}]),c=function(e,t){let r=e,s=n.exec(t.lines()[t.index()+1]);for(;null!=s&&void 0!==s&&s.length>0;)r+=s[1],t.skip(),s=n.exec(t.lines()[t.index()+1]);return i.unescape(r)},u=function(e,t){const r=e;let n=t||-1,i=null;return{reset:function(){n=-1},skip:function(e){n+=e||1},index:function(){return n},token:function(){return match},lines:function(){return r},next:function(){return n++,i=n<r.length?function(e,t){let r=e.search(s);if(-1==r)return;const n={key:e.substring(0,r),value:c(e.substring(r+1),t)};return r=n.key.search(a),-1!=r&&(n.parameter=function(e){if(null==e||void 0===e)return;const t=e.split(a),r={};return t.forEach((e=>{const t=e.split(o);r[t[0].toLowerCase()]=t[1]})),r}(n.key.substring(r+1)),n.key=n.key.substring(0,r)),n}(r[n],this):null,Promise.resolve(i)},clone:function(){return new u(r,n)}}};function l(e){return new u(e.split(/\r?\n/g).filter((e=>e.trim().length>0)))}class p{constructor(e,t){this.key=e,this.context=t}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(e){this.context[this.key]=e}set append(e){if(this.hasValue){const t=this.value;t instanceof Array?t.push(e):this.value=[this.value,e]}else this.value=e}remove(){delete this.context[this.key]}static load(e,t,r=!0){let n=e;const s=t.split(".");let a=s.shift().trim();for(;s.length>0;){if(!n[a]){if(!r)return null;n[a]={}}n=n[a],a=s.shift().trim()}return new p(a,n)}}const f=function(e){return void 0!==e&&null!=e&&"Object"===e.constructor.name},d=function(e,...t){e||(e={});for(let r of t)f(r)&&Object.getOwnPropertyNames(r).forEach((t=>{f(e[t])?d(e[t],r[t]):e[t]=r[t]}));return e},h=function(){const[e,t,{deep:r=!1,recursive:n=!0,parents:s=[]}={}]=arguments,a={};for(let o in e){const i=e[o],c=t(o,i,e);!c||r&&null!=i?c&&r&&("object"!=typeof i||i instanceof Array||i instanceof Map||i instanceof Set||i instanceof RegExp||s.includes[i]||i==e?a[o]=i:a[o]=h(i,t,{deep:r,recursive:n,parents:s.concat(e)})):a[o]=i}return a},y={isPojo:f,append:function(e,t,r){return void 0!==t&&(p.load(r,e,!0).append=t),r},merge:d,filter:h,buildPropertyFilter:function({names:e,allowed:t}){return(r,n,s)=>e.includes(r)===t},defValue:(e,t,r)=>{Object.defineProperty(e,t,{value:r,writable:!1,configurable:!1,enumerable:!1})},defGet:(e,t,r)=>{Object.defineProperty(e,t,{get:r,configurable:!1,enumerable:!1})},defGetSet:(e,t,r,n)=>{Object.defineProperty(e,t,{get:r,set:n,configurable:!1,enumerable:!1})}},v=/^begin$/i,m=/^end$/i,g=function(e,t,r){return e.next().then((n=>n?function(e,t,r,n){return m.test(e.key)?Promise.resolve(n):v.test(e.key)?g(t,r,{}).then((s=>{if(void 0===n)return Promise.resolve(s);const a=y.append(e.value.toLowerCase(),s,n);return g(t,r,a)})):function(e,t){try{const r=e.key.toLowerCase();if(void 0!==t.propertyparser&&"function"==typeof t.propertyparser[r]){const n=t.propertyparser[r](e);if(void 0!==n)return n instanceof Promise?n:Promise.resolve(n)}}catch(e){console.error(e)}return t.onlyPropertyValues?Promise.resolve(e.value):Promise.resolve({_type_:"property",parameter:e.parameter,value:e.value})}(e,r).then((t=>y.append(e.key.toLowerCase(),t,n))).then((e=>g(t,r,e)))}(n,e,t,r):Promise.resolve(r)))},P=function(e,t){return g(new l(e),t||{}).then((e=>"function"==typeof t.map?Promise.resolve(t.map(e)):Promise.resolve(e)))},b=/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})/,x=e=>{const t=b.exec(e.value);return t?new Date(parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseInt(t[6])):e.value},k={onlyPropertyValues:!0,propertyparser:{organizer:e=>({name:/([^"]+)/i.exec(e.parameter.cn)[1],mail:/^(mailto:)?(.+)$/i.exec(e.value)[2]}),dtstart:x,dtend:x}},w={parse:(e,t)=>P(e,function(e){return void 0===e||null==e?k:y.merge({},k,e)}(t))},j={Parser:P,ICalendar:w},E=window||E||self||{};E.defaultjs=E.defaultjs||{},E.defaultjs.ical=E.defaultjs.ical||{VERSION:"1.0.1",Parser:j.Parser,ICalendar:j.ICalendar},"function"==typeof E.fetch&&void 0!==E.Response&&void 0!==E.Response.prototype&&void 0===E.Response.prototype.ical&&(E.Response.prototype.ical=function(e){return this.text().then((function(t){return j.ICalendar.parse(t,e)}))})})();
//# sourceMappingURL=browser-defaultjs-ical.min.js.map